"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7238],{7238:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var l=a(9950),s=a(1072),i=a(28429),o=a(37017),n=a(42074),c=a(45532),r=a(79988),d=a(7864),m=a(74297),h=a(27760),u=a(76058),p=a(84257),x=a(44885),y=a(55271),j=(a(46411),a(44414));const _=function(){(0,i.Zp)();let e=(0,s.A)();const{user:t,authTokens:a}=(0,l.useContext)(c.A);let[_,v]=(0,l.useState)([]),[b,f]=(0,l.useState)([]),[g,w]=(0,l.useState)([]),[k,C]=(0,l.useState)([]),[q,N]=(0,l.useState)([]),[S,F]=(0,l.useState)([]),[M,D]=(0,l.useState)([]),[A,P]=(0,l.useState)();const[T,O]=(0,l.useState)(!1),[U,L]=(0,l.useState)(!1),[W,I]=(0,l.useState)(!1),[Q,R]=(0,l.useState)(!1),[V,K]=(0,l.useState)(!1),[z,B]=(0,l.useState)([]),[E,G]=(0,l.useState)(!1),{selectedColor:Z}=(0,x.useColor)();let[J,H]=(0,l.useState)([]),[Y,X]=(0,l.useState)([]),[$,ee]=(0,l.useState)(),te=(0,m.A)();(0,l.useEffect)((()=>{ae()}),[]);let ae=async()=>{let t=await e.get("/machine/api/get_machine_and_qrcode/");if(1===t.data.success){let e=[];for(let a=0;a<t.data.result.length;a++){let l=t.data.result[a];e.push(l.machine_id)}f(e)}else if(0===t.data.success)for(let e=0;e<Object.values(t.data.result).length;e++){let a=Object.values(t.data.result)[e];alert(a)}};(0,l.useEffect)((()=>{le()}),[]);let le=async()=>{let t=await e.get("/machine/api/get_machine_and_qrcode/"),a=await e.get("/machine/api/get_unused_qrcode/"),l=await e.get("/machine/get_product_list/"),s=await e.get("/machine/modelcapacity/");if(1===t.data.success&&1===a.data.success){let e=[];for(let a=0;a<t.data.result.length;a++){let l=t.data.result[a],s={id:l.id,machine_id:l.machine_id,rqcode:l.rqcode,created_at:l.created_at,qr_code_img:l.qr_code_img,product_type:l.product_type,amount:l.amount,model_no:l.model_no,name:l.name,installation_location:l.location,payment_type:l.payment_type,machinelease:l.machinelease,status:!0===l.is_active?"Active":"Inactive"};e.push(s)}let i=[];for(let t=0;t<a.data.result.length;t++){let e=a.data.result[t];if(1==e.is_active){let t={label:e.qr_code_id,value:e.id};i.push(t)}}let o=[];for(let t=0;t<l.data.result.length;t++){let e=l.data.result[t],a={label:e.product_type,value:e.id,amount:e.amount};o.push(a)}let n=[];for(let t=0;t<s.data.result.length;t++){let e=s.data.result[t],a={value:e.id,label:e.model_no,name:e.name};n.push(a)}v(e),w(i),C(o),N(n)}else if(0===t.data.success)for(let e=0;e<Object.values(t.data.result).length;e++){let a=Object.values(t.data.result)[e];alert(a)}};const se=async e=>{let t=[];null===_||void 0===_||_.map((a=>{a.rqcode==e.rqcode&&t.push(e.rqcode)})),null===g||void 0===g||g.map((a=>{a.label!=e.rqcode&&t.push(a.label)}));let a=[];null===k||void 0===k||k.map((t=>{t.value==e.payment_type&&a.push(t)})),null===k||void 0===k||k.map((t=>{t.value!=e.payment_type&&a.push(t)})),H(t),X(a)},ie=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],s=t.getFullYear(),i=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return"".concat(a," - ").concat(l," - ").concat(s," ").concat(i,":").concat(o)};return ie(),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"mb-3",children:[(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,j.jsx)("h3",{className:"mb-0",style:{color:"#2C384A"},children:"Machine Master"})," ",(0,j.jsx)(o.Q_,{onClick:()=>{L(!U)},className:"mt-2",style:{backgroundColor:Z,color:"white",border:"0px "},children:"Add New"})]}),(0,j.jsx)("div",{className:"row mt-2",children:(0,j.jsx)(o.qI,{onSubmit:async t=>{t.preventDefault();const a=new FormData(t.target);let l=await e.post("/machine/bulkuploadmachinemaster/bulk-upload/",a);1===l.data.success?(alert("Machine id is created"),le(),window.location.reload()):1!=l.data.success&&alert(l.data.message)},children:(0,j.jsxs)(o.sK,{children:[(0,j.jsxs)(o.UF,{md:5,children:[(0,j.jsx)(o.A6,{htmlFor:"file1",style:{fontWeight:"600"},children:"Upload Bulk Data"}),"\xa0\xa0",(0,j.jsx)(n.N_,{onClick:function(){const e=y.Wp.book_new(),t=[["machineid","qrcodeid","producttype","modelno","paymenttype","machinelease","installationlocation","name","amount","qrstorename","qrstoreid","upilink"],["machine id 1","qrcode id 1","product type 1","model no 1","paymenttype 1","machinelease 1","installationlocation 1","name 1","amount 1","qrstorename 1","qrstoreid 1","upilink 1"],["machine id 2","qrcode id 2","product type 2","model no 2","paymenttype 2","machinelease 2","installationlocation 2","name 2","amount 2","qrstorename 2","qrstoreid 2","upilink 2"],["machine id 3","qrcode id 3","product type 3","model no 3","paymenttype 3","machinelease 3","installationlocation 3","name 3","amount 3","qrstorename 3","qrstoreid 3","upilink 3"],["machine id 4","qrcode id 4","product type 4","model no 4","paymenttype 4","machinelease 4","installationlocation 4","name 4","amount 4","qrstorename 4","qrstoreid 4","upilink 4"],["machine id 5","qrcode id 5","product type 5","model no 5","paymenttype 5","machinelease 5","installationlocation 5","name 5","amount 5","qrstorename 5","qrstoreid 5","upilink 5"]],a=y.Wp.aoa_to_sheet(t);a["!views"]||(a["!views"]=[]),a["!views"].push({state:"frozen",xSplit:0,ySplit:1}),y.Wp.book_append_sheet(e,a,"Sheet 1"),y._h(e,"sampledownload.xlsx")},children:"Download Sample"}),(0,j.jsx)(o.OG,{type:"file",id:"file",name:"file",required:!0,accept:".xlsx",size:"sm"}),(0,j.jsx)(o.To,{invalid:!0,children:"please upload the file"})]}),(0,j.jsxs)(o.UF,{md:7,children:[(0,j.jsx)(o.A6,{htmlFor:"button",style:{fontWeight:"600"},children:"\xa0\xa0\xa0\xa0\xa0\xa0"}),"\xa0\xa0",(0,j.jsx)(o.Q_,{type:"submit",style:{backgroundColor:Z,color:"white",marginTop:"29px"},children:"Add"})]})]})})}),(0,j.jsx)(o.sK,{children:(0,j.jsx)(o.UF,{xs:12,children:(0,j.jsx)(o.Pd,{activePage:1,clickableRows:!0,columns:[{key:"sr_no",label:"Sr No.",sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"60px"}},{label:"Machine ID",key:"machine_id",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"100px"},sorter:!1},{label:"QR Code ID",key:"rqcode",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"100px"},sorter:!1},{label:"Image",key:"qr_code_img",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Location",key:"installation_location",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Product Type",key:"product_type",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Amount",key:"amount",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Model No",key:"model_no",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Capacity",key:"name",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Payment Mode",key:"payment_type",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Machine Availability",key:"machinelease",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{label:"Created Date",key:"created_at",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{key:"Action",label:"Action",filter:!1,sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"100px"}}],items:_,itemsPerPageSelect:!0,itemsPerPage:10,pagination:!0,scopedColumns:{qr_code_img:e=>(0,j.jsx)("td",{children:(0,j.jsx)(o.he,{className:"smarttablecardimg",orientation:"top",src:te+e.qr_code_img})}),Action:e=>(0,j.jsxs)("td",{children:[(0,j.jsx)(n.N_,{to:"#",children:(0,j.jsx)(d.A,{icon:h.K,style:{color:"blue"},size:"md",title:"Edit",onClick:()=>[P(e),O(e.id),I(!W),se(e)]})}),"\xa0\xa0\xa0",(0,j.jsx)(n.N_,{to:"/Machineview/"+"".concat(e.id),children:(0,j.jsx)(o.t7,{src:r,width:17,height:15,title:"View Details"})})," ","\xa0\xa0\xa0",(0,j.jsx)(n.N_,{to:"#",onClick:()=>(e=>{const t="".concat(te)+"/"+e,a=new Request(t,{method:"GET"});fetch(a).then((e=>{if(e.ok)return console.log(e),e.blob();console.error("Request failed:",e.statusText)})).then((e=>{const t=window.URL.createObjectURL(e),a=document.createElement("a");a.style.display="none",a.href=t,a.download="QR_code_Image_"+ie(new Date)+".png",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(t)})).catch((e=>{console.error("Network error:",e)}))})(e.qr_code_img),children:(0,j.jsx)(d.A,{icon:u.n,style:{color:"blue"},size:"md",width:"17",title:"Download"})})]}),sr_no:(e,t)=>(0,j.jsx)("td",{children:t+1}),created_at:e=>(0,j.jsx)("td",{children:ie(e.created_at)})},itemsPerPageOptions:[10,20,50,100],tableProps:{color:"success-color-secondary",hover:!0,border:"1.5px solid #074",responsive:!0},tableHeadProps:{color:"light",align:"middle"},tableBodyProps:{align:"middle"},tableFilterPlaceholder:"Enter String to Search",itemsPerPageLabel:"Rows per page:"})})})]}),(0,j.jsxs)(o.zS,{size:"lg",visible:U,onClose:()=>[L(!1),K(!1),G(!1)],backdrop:"static",children:[(0,j.jsx)(o.E4,{onClose:()=>[L(!1),K(!1),G(!1)],style:{backgroundColor:Z,color:"white"},children:(0,j.jsx)(o.lb,{children:"Machine Master"})}),(0,j.jsxs)(o.qI,{className:"row g-3 needs-validation",style:{margin:"10px"},noValidate:!0,validated:V,onSubmit:t=>{t.preventDefault(),(async t=>{const a=t.currentTarget;if(t.preventDefault(),!0===a.checkValidity())if(null!==b&&void 0!==b&&b.includes(t.target.machine_id.value))alert("This machine id is already exists");else{const a=new FormData(t.target);a.append("is_active",!0);let l=await e.post("/machine/machine-masters/",a);if(1===l.data.success)alert("Machine id is created"),K(!1),L(!1),le(),window.location.reload();else if(0===l.data.success)for(let e=0;e<Object.values(l.data.result).length;e++){let t=Object.values(l.data.result)[e];alert(t)}}else K(!0)})(t),t.currentTarget.checkValidity()},children:[(0,j.jsxs)(o.Tc,{children:[(0,j.jsxs)(o.sK,{sm:12,className:"",children:[(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsxs)(o.A6,{htmlFor:"validationDefault01",children:["Add Machine Id",(0,j.jsx)("span",{className:"text-danger",children:"*"})]}),(0,j.jsx)(o.OG,{type:"text",id:"machine_id",name:"machine_id",required:!0,maxLength:50}),(0,j.jsx)(o.To,{invalid:!0,children:"Please create machine id"})]}),(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Qr Code Id"}),(0,j.jsx)(o.MT,{name:"rqcode",options:g}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Qr code Id"})]})]}),(0,j.jsxs)(o.sK,{sm:12,className:"",children:[(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Product"}),(0,j.jsx)(o.MT,{name:"product",options:k}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Product"})]}),(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Model Number"}),(0,j.jsx)(o.MT,{name:"model_number",options:q}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Model Number"})]})]}),(0,j.jsxs)(o.sK,{sm:12,className:"",children:[(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Payment mode"}),(0,j.jsxs)(o.MT,{name:"payment_type",children:[(0,j.jsx)("option",{value:"",children:"Select Payment Mode"}),(0,j.jsx)("option",{value:" Only QRCode",children:" QRCode"}),(0,j.jsx)("option",{value:"Only Coin",children:" Coin"}),(0,j.jsx)("option",{value:"Both",children:"Both"})]}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Payment mode"})]}),(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Machine Availability"}),(0,j.jsxs)(o.MT,{name:"machinelease",children:[(0,j.jsx)("option",{value:"",children:"Select Machine Availability"}),(0,j.jsx)("option",{value:"Demo",children:" Demo"}),(0,j.jsx)("option",{value:"Lease",children:" Lease"}),(0,j.jsx)("option",{value:"Sold",children:"Sold"})]}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Machine Availability"})]})]}),(0,j.jsx)(o.sK,{sm:12,className:"",children:(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsxs)(o.A6,{htmlFor:"validationDefault01",children:["Location",(0,j.jsx)("span",{className:"text-danger",children:"*"})]}),(0,j.jsx)(o.OG,{type:"text",id:"installation_location",name:"installation_location",required:!0,maxLength:50}),(0,j.jsx)(o.To,{invalid:!0,children:"Please enter location"})]})})]}),(0,j.jsxs)(o.If,{children:[(0,j.jsx)(o.Q_,{onClick:()=>[L(!1),K(!1),G(!1)],style:{backgroundColor:"#F5F5F5",color:"black",borderColor:"#DCDCDC"},children:"\xa0Close\xa0"}),(0,j.jsxs)(o.Q_,{type:"submit",style:{backgroundColor:Z,color:"white"},disabled:E,children:[(0,j.jsx)(d.A,{icon:p.B,style:{color:"white"},size:"sm"}),"\xa0 ","Submit"]})]})]})]}),(0,j.jsxs)(o.zS,{size:"lg",visible:W,onClose:()=>[I(!1),K(!1)],backdrop:"static",children:[(0,j.jsx)(o.E4,{onClose:()=>[I(!1),K(!1)],style:{backgroundColor:Z,color:"white"},children:(0,j.jsx)(o.lb,{children:"Update Machine Master"})}),(0,j.jsxs)(o.qI,{className:"row g-3 needs-validation",style:{margin:"10px"},noValidate:!0,validated:V,onSubmit:async t=>{const a=t.currentTarget;if(t.preventDefault(),!0===a.checkValidity()){const a=new FormData(t.target);let l=await e.patch("/machine/machine-masters/".concat(T,"/"),a);if(1===l.data.success)alert("Machine id is updated"),K(!1),I(!1),le();else if(0===l.data.success)for(let e=0;e<Object.values(l.data.result).length;e++){let t=Object.values(l.data.result)[e];alert(t)}}K(!0)},children:[(0,j.jsxs)(o.Tc,{children:[(0,j.jsxs)(o.sK,{sm:12,className:"",children:[(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsxs)(o.A6,{htmlFor:"validationDefault01",children:["Machine ID",(0,j.jsx)("span",{className:"text-danger",children:"*"})]}),(0,j.jsx)(o.OG,{type:"text",id:"machine_id",name:"machine_id",required:!0,defaultValue:null===A||void 0===A?void 0:A.machine_id,maxLength:50}),(0,j.jsx)(o.To,{invalid:!0,children:"Please enter machine id"})]}),(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"QR Code Id"}),(0,j.jsx)(o.MT,{name:"rqcode",defaultValue:null===A||void 0===A?void 0:A.rqcode,options:J}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select QR code Id"})]})]}),(0,j.jsxs)(o.sK,{sm:12,className:"",children:[(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Product"}),(0,j.jsx)(o.MT,{name:"product",options:k,defaultValue:null===A||void 0===A?void 0:A.product}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Product"})]}),(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Payment mode"}),(0,j.jsxs)(o.MT,{name:"payment_type",defaultValue:null===A||void 0===A?void 0:A.payment_type,children:[(0,j.jsx)("option",{value:"",children:"Select Payment Mode"}),(0,j.jsx)("option",{value:" Only QRCode",children:" Only QRCode"}),(0,j.jsx)("option",{value:"Only Coin",children:" Only Coin"}),(0,j.jsx)("option",{value:"Both",children:"Both"})]}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Payment mode"})]})]}),(0,j.jsxs)(o.sK,{sm:12,className:"",children:[(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsxs)(o.A6,{htmlFor:"validationDefault01",children:["Location",(0,j.jsx)("span",{className:"text-danger",children:"*"})]}),(0,j.jsx)(o.OG,{type:"text",id:"installation_location",name:"installation_location",required:!0,defaultValue:null===A||void 0===A?void 0:A.installation_location,maxLength:50}),(0,j.jsx)(o.To,{invalid:!0,children:"Please enter location"})]}),(0,j.jsxs)(o.UF,{sm:6,children:[(0,j.jsx)(o.A6,{htmlFor:"validationDefault01",children:"Model Number"}),(0,j.jsx)(o.MT,{name:"model_number",options:q,defaultValue:null===A||void 0===A?void 0:A.model_number}),(0,j.jsx)(o.To,{invalid:!0,children:"Please select Model Number"})]})]})]}),(0,j.jsxs)(o.If,{children:[(0,j.jsx)(o.Q_,{onClick:()=>[I(!1),K(!1)],style:{backgroundColor:"#F5F5F5",color:"black",borderColor:"#DCDCDC"},children:"\xa0Close\xa0"}),(0,j.jsxs)(o.Q_,{type:"submit",style:{backgroundColor:Z,color:"white"},children:[(0,j.jsx)(d.A,{icon:p.B,style:{color:"white"},size:"sm"}),"\xa0Submit"]})]})]})]})]})}},76058:(e,t,a)=>{a.d(t,{n:()=>l});const l=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='367.997 338.75 271.999 434.747 271.999 17.503 239.999 17.503 239.999 434.745 144.003 338.75 121.376 361.377 256 496 390.624 361.377 367.997 338.75' class='ci-primary'/>"]},84257:(e,t,a)=>{a.d(t,{B:()=>l});const l=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M199.066,456l-7.379-7.514-3.94-3.9-86.2-86.2.053-.055L17.936,274.665l97.614-97.613,83.565,83.565L398.388,61.344,496,158.958,296.729,358.229,285.469,369.6ZM146.6,358.183l52.459,52.46.1-.1.054.054,52.311-52.311,11.259-11.368L450.746,158.958,398.388,106.6,199.115,305.871,115.55,222.306,63.191,274.665l83.464,83.463Z' class='ci-primary'/>"]},27760:(e,t,a)=>{a.d(t,{K:()=>l});const l=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M29.663,482.25l.087.087a24.847,24.847,0,0,0,17.612,7.342,25.178,25.178,0,0,0,8.1-1.345l142.006-48.172,272.5-272.5A88.832,88.832,0,0,0,344.334,42.039l-272.5,272.5L23.666,456.541A24.844,24.844,0,0,0,29.663,482.25Zm337.3-417.584a56.832,56.832,0,0,1,80.371,80.373L411.5,180.873,331.127,100.5ZM99.744,331.884,308.5,123.127,388.873,203.5,180.116,412.256,58.482,453.518Z' class='ci-primary'/>"]}}]);